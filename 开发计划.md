一、后端设计（核心逻辑层）

后端核心由 任务调度 + 指标计算 + 条件判断 + 推送通知 + 用户配置管理 五部分组成。

后端模块划分（可独立开发/测试）

### 1. Stock Monitor Service（股票监控服务）

负责核心计算：

拉取实时行情数据

计算 RSI

判断是否触发阈值

写入触发日志

子模块

market_data_service.py：从 AkShare/Tushare 获取股票的实时数据

indicator_service.py：计算 RSI、MACD、MA 等

signal_engine.py：基于规则判断是否触发

scanner.py：周期扫描模块

核心流程

周期调度 → 获取实时价格 → 计算 RSI → 判断 RSI < 阈值 → 推入 Alarm Queue

数据结构示例（内部使用）

{
"code": "600519",
"name": "贵州茅台",
"price": 1620.88,
"rsi6": 22.4,
"timestamp": 1732079350
}

### 2. Strategy Config Service（策略配置服务）

负责管理用户的监控策略。

功能：

用户管理自选股

用户设置 RSI 阈值等参数

保存通知方式（email/tg）

数据持久化（SQLite / MySQL）

表结构建议：

user_stock（用户自选股）

| id | user_id | stock_code | stock_name | created_at |

user_strategy（用户策略）

| id | user_id | stock_code | rsi_low | rsi_high | enable_push |

user_notify（通知方式）

| id | user_id | telegram_id | email | notify_rate_limit |

可选：使用 SQLite 先跑，再扩展到 MySQL。

### 3. Notification Service（通知推送服务）

支持两种通知方式：

email（使用 SMTP）

Telegram Bot

模块内容：

email_service.py

telegram_service.py

notify_router.py（按用户配置选择推送渠道）

推送格式

【RSI 触底提醒】
股票：贵州茅台（600519）
最新价格：1620.88
RSI6：22.4

触发理由：RSI < 25（你设置的阈值）
时间：2025-11-20 10:25

### 4. Alarm Queue（告警队列）

用于解耦扫描和推送。
你可以用：

Redis List

Cleaner：处理队列内容并通知用户

队列消息格式：

{
"user_id": 1,
"stock_code": "600519",
"reason": "RSI_Low",
"value": 22.4,
"threshold": 25,
"time": 1732079350
}

### 5. Scheduler（调度器）

建议不做复杂框架，直接用：

APScheduler（简单）
or

Celery Beat（后期扩展）

调度任务：

monitor_task：每 3 秒拉一次行情

daily_report_task（可选）

queue_worker_task：监听告警队列并推送

🟦 后端模块整体架构图
┌────────────┐
│ Scheduler │
│ (APSched) │
└──────┬──────┘
│
┌───────────▼──────────┐
│ Stock Monitor Service │
│ (行情 + 指标 + 判断)│
└───────┬─────────────┘
│ Alarm Event
┌───────▼─────────────┐
│ Alarm Queue │
└───────┬─────────────┘
│
┌───────▼─────────────┐
│ Notification Service │
└──────────────────────┘

     ┌──────────────────────┐
     │ Strategy Config API  │
     └──────────────────────┘

✅ 二、前端设计（简单可用版）

前端只需要三个页面即可满足你的当前需求。

前端模块划分

### 1. 股票管理页面（Stock List Page）

功能：

输入股票代码（自动补全）

添加到监控列表

显示每个股票的当前状态（是否监控中）

可删除

接口：

GET /api/stock/list
POST /api/stock/add
POST /api/stock/delete

### 2. 策略设置页面（Strategy Setting Page）

每只股票可以配置：

RSI low 阈值（默认 30）

RSI high 阈值（默认 70）

是否启用通知开关

还可扩展：

是否启用背离检测

是否使用多周期共振

接口：

GET /api/strategy/:stock_code
POST /api/strategy/update

### 3. 通知设置页面（Notification Setting）

配置通知方式：

邮箱

Telegram（输入 bot chat id）

接口：

GET /api/user/notify
POST /api/user/notify/update

🟦 前端整体结构图
┌ Stock List (自选股)
│ ├ 添加股票
│ ├ 查看实时监控状态
│ └ 删除
│
├ Strategy Setting (策略设置)
│ ├ RSI Low/High
│ └ 启用通知
│
└ Notification Setting (推送设置)
├ Email
└ Telegram

前端可以用：

Vue 3 + Element Plus
或

React + Ant Design

如果你希望“轻量”，可以直接 Electron + Vue。

第一部分：核心功能拓展点（如何让策略更有效？）
单纯的 RSI < 30 买入，RSI > 70 卖出，在 A 股胜率通常不高。我们需要围绕它构建“过滤器”和“增强器”。

1. 策略深度的扩展（从“信号”到“系统”）
   背离检测（Divergence）： 比数值更重要的是背离。
   底背离报警： 股价创新低，但 RSI 未创新低（买入信号更强）。
   顶背离报警： 股价创新高，但 RSI 未创新高（卖出信号更强）。
   多周期共振：
   不仅看日线。如果日线 RSI 在低位，且 60 分钟、30 分钟 RSI 同时也出现金叉，权重加倍。
   趋势过滤（Trend Filter）：
   在下跌趋势中，RSI 跌破 30 可能只是半山腰。引入 MA（均线） 或 MACD 作为过滤器。例如：只有当股价在 200 日均线之上（牛市背景）时，RSI < 30 才报警；或者结合 布林带（Bollinger Bands） 触底。
   RSI 钝化处理：
   检测“连续钝化”：如果 RSI 连续 3 天低于 20，说明极度弱势，不要急于抄底，等 RSI 重新突破 30 的那一刻再报警。
2. 数据面的扩展（A 股特色）
   资金流向结合： RSI 提示超卖，同时检测“北向资金”或“主力资金”是否在逆势净流入。
   板块热点关联： 个股 RSI 触底，检查其所属板块（如“新能源”、“半导体”）指数是否也同步触底。
3. 风险控制（理论指导的核心）
   ATR 止损计算： 报警的同时，根据 ATR（平均真实波幅）计算出建议的止损价位。
   仓位管理建议： 根据 RSI 的极端程度（如 RSI=15 比 RSI=29 更极端），给出建议的仓位比例（凯利公式）。
   第二部分：项目开发规划书
4. 项目愿景
   打造一款**“量化辅助、理性决策”**的 A 股智能盯盘助手，帮助散户捕捉短线超跌反弹机会与超买风险提示，而非简单的荐股软件。
5. 技术架构选型
   数据源 (Data Layer):
   免费/低成本： AkShare (Python 开源库，基于新浪/东方财富接口)、TuShare Pro。
   实时性要求： A 股每 3 秒刷新一次，需搭建 WebSocket 或高频轮询服务。
   后端 (Logic Layer):
   Python (Pandas/Numpy 处理数据，TA-Lib 计算指标)。
   Celery/Redis (处理定时任务和实时报警队列)。
   客户端 (Client Layer):
   PC 端： Electron (跨平台) 或 PyQT (开发快)。
   移动端： Flutter 或 微信小程序 (触达最快，但需注意合规审核)。
6. 功能模块路线图 (Roadmap)
   目标： 跑通数据流，实现最基础的监控。
   功能：
   自选股池： 用户输入股票代码（如 600519）。
   实时计算： 获取实时价格，计算当前 RSI(6, 12, 24)。
   基础阈值报警： RSI < 30 或 RSI > 70 时，触发系统弹窗或声音提示。
   简单的 K 线图展示： 并在图上标记出 RSI 数值。
   目标： 让用户相信策略有效，减少误报。
   功能：
   全市场扫描（选股器）： 不再局限于自选股，每分钟扫描全 A 股 5000 只股票，列出当前 RSI < 20 的股票清单。
   历史回测功能（核心卖点）： 用户点击某只股票，系统展示：“如果在过去 1 年依据 RSI < 30 买入，胜率是多少？平均收益是多少？” （这是用户付费意愿的来源）。
   多条件组合： 允许用户设置 RSI < 30 AND MACD 金叉。
   目标： 随时随地接收信号。
   功能：
   消息推送： 对接微信服务号模板消息或钉钉/飞书机器人（个人开发最容易实现的路径）。
   云端同步： 用户的自选股和策略配置同步在云端。
   复盘日报： 盘后自动生成当日触发信号的股票表现统计。
   目标： 建立护城河。
   功能：
   AI 模式识别： 训练模型识别 K 线形态（如“早晨之星”配合 RSI 超卖）。
   用户情绪指标： 统计所有用户关注股票的 RSI 分布，生成“市场情绪温度计”。
